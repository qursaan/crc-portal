var schedulerjsTemplates=function(){var a={layout:new Hogan.Template({code:function(a,b,c){var d=this;return d.b(c=c||""),d.b('<div class="sjs-wrapper">\r'),d.b("\n"+c),d.b('    <div class="sjs-name-col">\r'),d.b("\n"+c),d.b('        <div class="sjs-name-head">'),d.b(d.v(d.f("head-name",a,b,0))),d.b("</div>\r"),d.b("\n"+c),d.s(d.f("names",a,b,1),a,b,0,133,193,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('            <div class="sjs-name">'),d.b(d.v(d.f("name",a,b,0))),d.b("</div>\r"),d.b("\n"+c)}),a.pop()),d.b("    </div>\r"),d.b("\n"+c),d.b('    <div class="sjs-app-col">\r'),d.b("\n"+c),d.b('        <div class="sjs-grid">\r'),d.b("\n"+c),d.b('            <div class="sjs-grid-row-head">\r'),d.b("\n"+c),d.s(d.f("grid-cols-head",a,b,1),a,b,0,360,520,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                    <div class="sjs-grid-col-head" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b('px;">\r'),d.b("\n"+c),d.b("                        "),d.b(d.v(d.f("time",a,b,0))),d.b("\r"),d.b("\n"+c),d.b("                    </div>\r"),d.b("\n"+c)}),a.pop()),d.b("            </div>\r"),d.b("\n"+c),d.s(d.f("grid-rows",a,b,1),a,b,0,587,826,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                <div class="sjs-grid-row">\r'),d.b("\n"+c),d.s(d.f("grid-cols",a,b,1),a,b,0,667,774,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                        <div class="sjs-grid-col" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b('px;"></div>\r'),d.b("\n"+c)}),a.pop()),d.b("                </div>\r"),d.b("\n"+c)}),a.pop()),d.b("        </div>\r"),d.b("\n"+c),d.b('        <div class="sjs-grid-overlay">\r'),d.b("\n"+c),d.b('            <div class="sjs-grid-overlay-row-head"></div>\r'),d.b("\n"+c),d.s(d.f("grid-overlay-rows",a,b,1),a,b,0,991,1608,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                <div class="sjs-grid-overlay-row">\r'),d.b("\n"+c),d.s(d.f("grid-overlay-cols",a,b,1),a,b,0,1087,1548,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                        <div class="sjs-grid-overlay-col '),d.b(d.v(d.f("class",a,b,0))),d.b('" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b("px;margin-left:"),d.b(d.v(d.f("margin",a,b,0))),d.b('px;" title="'),d.b(d.v(d.f("title",a,b,0))),d.b(" "),d.b(d.v(d.f("start",a,b,0))),d.b("-"),d.b(d.v(d.f("end",a,b,0))),d.b('" data-payload-id="'),d.b(d.v(d.f("payloadId",a,b,0))),d.b('">\r'),d.b("\n"+c),d.b('                            <span class="sjs-grid-overlay-col-title">'),d.b(d.v(d.f("title",a,b,0))),d.b("</span>\r"),d.b("\n"+c),d.b("                            <br />\r"),d.b("\n"+c),d.b('                            <span class="sjs-grid-overlay-col-time">'),d.b(d.v(d.f("start",a,b,0))),d.b("-"),d.b(d.v(d.f("end",a,b,0))),d.b("</span>\r"),d.b("\n"+c),d.b("                        </div>\r"),d.b("\n"+c)}),a.pop()),d.b("                </div>\r"),d.b("\n"+c)}),a.pop()),d.b("        </div>\r"),d.b("\n"+c),d.b('        <div class="sjs-fill-height"></div>\r'),d.b("\n"+c),d.b('        <div class="sjs-selector">\r'),d.b("\n"+c),d.b('            <div class="sjs-selector-edge sjs-selector-left"></div>\r'),d.b("\n"+c),d.b('            <div class="sjs-selector-edge sjs-selector-right"></div>\r'),d.b("\n"+c),d.b('            <div class="sjs-selector-inner">\r'),d.b("\n"+c),d.b('                <div class="sjs-selector-text">Start</div>\r'),d.b("\n"+c),d.b("            </div>\r"),d.b("\n"+c),d.b("        </div>\r"),d.b("\n"+c),d.b("    </div>\r"),d.b("\n"+c),d.b("</div>"),d.fl()},partials:{},subs:{}})},b=function(b){var c=a[b];return function(b,d,e){return c.render(b,d||a,e)}};return{layout:b("layout")}}();!function(a,b,c,d){function e(b,c){this.element=b,this.opts=a.extend({},e.defaults,c),this.minMinutes=0,this.maxMinutes=1440,this.start=0,this.end=0,this.stepsMinutes=[],this.nameList=[],this.payloadById={},this.createView(),this.setListeners(),this.start=this.minMinutes+60,this.end=this.start+60,this.opts.start!==d&&(this.start=this.timeStrToMinutes(this.opts.start)),this.opts.end!==d&&(this.end=this.timeStrToMinutes(this.opts.end)),this.updateSelector()}e.defaults={pixelsPerHour:200,snapTo:5,steps:["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00"],headName:"Names",onClickAppointment:function(){},list:[]},e.prototype["public"]={selected:function(){return{start:this.minutesToTimeStr(this.start),end:this.minutesToTimeStr(this.end)}},start:function(a){return a!==d&&(this.start=this.timeStrToMinutes(a),this.updateSelector()),this.minutesToTimeStr(this.start)},end:function(a){return a!==d&&(this.end=this.timeStrToMinutes(a),this.updateSelector()),this.minutesToTimeStr(this.end)},update:function(a){this.nameList=[],this.payloadById={},this.opts.list=a,this.createView(),this.updateSelector()},showSelector:function(){this.element.find(".sjs-selector").show()},hideSelector:function(){this.element.find(".sjs-selector").hide()},toggleSelector:function(){this.element.find(".sjs-selector").toggle()}},e.prototype.setListeners=function(){var b=this,c=null,e=null,f=null,g=null;this.element.on("mousemove",function(a){var d,h;c?(d=b.pageOffsetToMinutes(a.pageX-g),b.moveSelector(d-b.start),b.updateSelector()):e?(d=b.pageOffsetToMinutes(a.pageX-g),b.resizeSelectorLeft(d-b.start),b.updateSelector()):f&&(h=b.pageOffsetToMinutes(a.pageX-g),b.resizeSelectorRight(h-b.end),b.updateSelector())}),this.element.on("mousedown",".sjs-selector",function(b){b.stopPropagation(),c=a(this),e=null,f=null,g=b.offsetX}),this.element.on("mousedown",".sjs-selector-left",function(b){b.stopPropagation(),c=null,e=a(this),f=null,g=b.offsetX}),this.element.on("mousedown",".sjs-selector-right",function(b){b.stopPropagation(),c=null,e=null,f=a(this),g=b.offsetX-f.width()}),this.element.on("mouseup",function(a){(c||e||f)&&(b.snapSelector(),c=null,e=null,f=null)}),this.element.on("mouseleave",function(a){(c||e||f)&&(b.snapSelector(),c=null,e=null,f=null)}),this.element.on("click",".sjs-grid-overlay-col",function(c){var e=a(this).data("payload-id");b.payloadById.hasOwnProperty(e)&&b.payloadById[e]!==d&&b.opts.onClickAppointment(b.payloadById[e])})},e.prototype.updateSelector=function(){var a=this.element.find(".sjs-selector");a.offset({left:this.minutesToPageOffset(this.start)}),a.width(this.minutesToPixels(this.end-this.start)),a.find(".sjs-selector-text").html(this.minutesToTimeStr(this.start)+" - "+this.minutesToTimeStr(this.end))},e.prototype.snapSelector=function(){var a=this.start%this.opts.snapTo,b=this.end%this.opts.snapTo;a>this.opts.snapTo/2?this.start+=this.opts.snapTo-a:this.start-=a,b>this.opts.snapTo/2?this.end+=this.opts.snapTo-b:this.end-=b,this.updateSelector()},e.prototype.resizeSelectorLeft=function(a){this.start+=a,this.start<this.minMinutes&&(this.start=this.minMinutes),this.end-this.start<this.opts.snapTo&&(this.start=this.end-this.opts.snapTo)},e.prototype.resizeSelectorRight=function(a){this.end+=a,this.end>this.maxMinutes&&(this.end=this.maxMinutes),this.end-this.start<this.opts.snapTo&&(this.end=this.start+this.opts.snapTo)},e.prototype.moveSelector=function(a){this.start+=a,this.end+=a,this.start<this.minMinutes&&(this.end+=this.minMinutes-this.start,this.start=this.minMinutes),this.end>this.maxMinutes&&(this.start+=this.maxMinutes-this.end,this.end=this.maxMinutes),this.end-this.start<this.opts.snapTo&&(this.end=this.start+this.opts.snapTo)},e.prototype.pageOffsetToTimeStr=function(a){return this.minutesToTimeStr(this.pageOffsetToMinutes(a))},e.prototype.timeStrToPageOffset=function(a){return this.minutesToPageOffset(this.timeStrToMinutes(a))},e.prototype.pageOffsetToMinutes=function(a){return this.pixelsToMinutes(a-this.getGridOffset())+this.minMinutes},e.prototype.minutesToPageOffset=function(a){return this.minutesToPixels(a-this.minMinutes)+this.getGridOffset()},e.prototype.getGridOffset=function(){return this.element.find(".sjs-grid").first().offset().left},e.prototype.minutesToPixels=function(a){return Math.round(a*this.opts.pixelsPerHour/60)},e.prototype.pixelsToMinutes=function(a){return Math.round(60*a/this.opts.pixelsPerHour)},e.prototype.timeStrToMinutes=function(a){var b=a.split(":");return 60*parseInt(b[0])+parseInt(b[1])},e.prototype.minutesToTimeStr=function(a){var b=Math.floor(a/60),c=a-60*b,d="";return d=10>b?"0"+String(b):String(b),d+=10>c?":0"+String(c):":"+String(c)},e.prototype.getGridOverlayRowData=function(){for(var a=[],b=0,c=0;c<this.opts.list.length;c++){for(var e=this.minMinutes,f=[],g=0;g<this.opts.list[c].appointments.length;g++){var h=this.opts.list[c].appointments[g],i=this.timeStrToMinutes(h.start),j=this.timeStrToMinutes(h.end);if(!(i>j)){j>this.maxMinutes&&(j=this.maxMinutes),i<this.minMinutes&&(i=this.minMinutes);var k=j-i,l=i-e;e=j;var m="";h.payload!==d&&(m+="sjs-grid-overlay-col-clickable "),h["class"]!==d&&(m+=h["class"]),this.payloadById[b]=h.payload,f.push({width:this.minutesToPixels(k),margin:this.minutesToPixels(l),"class":m,title:h.title,start:h.start,end:h.end,payloadId:b}),b++}}a.push({"grid-overlay-cols":f})}return a},e.prototype.createView=function(){this.nameList=this.opts.list.map(function(a){return{name:a.name}}),this.stepsMinutes=this.opts.steps.map(this.timeStrToMinutes),this.minMinutes=Math.min.apply(Math,this.stepsMinutes),this.maxMinutes=Math.max.apply(Math,this.stepsMinutes);for(var a=[],b=[],c=0;c<this.stepsMinutes.length-1;c++){var d=this.stepsMinutes[c+1]-this.stepsMinutes[c];a.push({width:this.minutesToPixels(d),time:this.opts.steps[c]}),b.push({width:this.minutesToPixels(d)})}var e=[];for(c=0;c<this.opts.list.length;c++)e.push({"grid-cols":b});this.element.html(schedulerjsTemplates.layout({names:this.nameList,"head-name":this.opts.headName,"grid-cols-head":a,"grid-rows":e,"grid-overlay-rows":this.getGridOverlayRowData()}));var f=this.element.find(".sjs-grid").first().height(),g=22,h=15;this.element.find(".sjs-fill-height").first().height(f+g),this.element.find(".sjs-selector").height(f+g-h)},a.fn.schedulerjs=function(b){var c,f=Array.prototype.slice.call(arguments,1),g="schedulerjs";return this.each(function(){var d;if(!a.data(this,g)){if("object"!=typeof b)return void a.error(g+" needs an options object for initialization.");a.data(this,g,new e(a(this),b))}d=a.data(this,g),"object"!=typeof b&&(d["public"][b]?c=d["public"][b].apply(d,f):a.error("Method "+b+" does not exist in "+g))}),c!==d?c:this}}(jQuery,window,document);